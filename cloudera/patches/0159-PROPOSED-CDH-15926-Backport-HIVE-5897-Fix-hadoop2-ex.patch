From 5000b6d907cb048fcb65681d97a4cb6f5fb0ec9d Mon Sep 17 00:00:00 2001
From: Brock Noland <brock@cloudera.com>
Date: Wed, 27 Nov 2013 14:12:08 -0600
Subject: [PATCH 159/375] PROPOSED: CDH-15926 - Backport HIVE-5897 - Fix hadoop2 execution environment Milestone 2

---
 beeline/pom.xml                         |    9 +++++++-
 hcatalog/core/pom.xml                   |   32 +++++++++++++++++++++++++++++++
 hcatalog/storage-handlers/hbase/pom.xml |   20 +++++++++++++++++++
 itests/qtest/pom.xml                    |    6 -----
 4 files changed, 60 insertions(+), 7 deletions(-)

diff --git a/src/beeline/pom.xml b/src/beeline/pom.xml
index fa65113..2d0d670 100644
--- a/src/beeline/pom.xml
+++ b/src/beeline/pom.xml
@@ -121,7 +121,7 @@
           <groupId>org.apache.hadoop</groupId>
           <artifactId>hadoop-core</artifactId>
           <version>${hadoop-20S.version}</version>
-         <optional>true</optional>
+          <optional>true</optional>
         </dependency>
       </dependencies>
     </profile>
@@ -134,6 +134,13 @@
           <version>${hadoop-23.version}</version>
           <optional>true</optional>
         </dependency>
+        <!-- test inter-project -->
+        <dependency>
+          <groupId>org.apache.hadoop</groupId>
+          <artifactId>hadoop-mapreduce-client-core</artifactId>
+          <version>${hadoop-23.version}</version>
+          <scope>test</scope>
+        </dependency>
       </dependencies>
     </profile>
   </profiles>
diff --git a/src/hcatalog/core/pom.xml b/src/hcatalog/core/pom.xml
index c069846..000ab25 100644
--- a/src/hcatalog/core/pom.xml
+++ b/src/hcatalog/core/pom.xml
@@ -130,6 +130,19 @@
         </dependency>
         <!-- test -->
         <dependency>
+          <groupId>com.sun.jersey</groupId>
+          <artifactId>jersey-servlet</artifactId>
+          <version>${jersey.version}</version>
+          <scope>test</scope>
+        </dependency>
+        <dependency>
+          <groupId>org.apache.hadoop</groupId>
+          <artifactId>hadoop-common</artifactId>
+          <version>${hadoop-23.version}</version>
+          <classifier>tests</classifier>
+          <scope>test</scope>
+        </dependency>
+        <dependency>
           <groupId>org.apache.hadoop</groupId>
           <artifactId>hadoop-hdfs</artifactId>
           <version>${hadoop-23.version}</version>
@@ -144,12 +157,31 @@
         </dependency>
         <dependency>
           <groupId>org.apache.hadoop</groupId>
+          <artifactId>hadoop-mapreduce-client-hs</artifactId>
+          <version>${hadoop-23.version}</version>
+          <scope>test</scope>
+        </dependency>
+        <dependency>
+          <groupId>org.apache.hadoop</groupId>
+          <artifactId>hadoop-mapreduce-client-jobclient</artifactId>
+          <version>${hadoop-23.version}</version>
+          <scope>test</scope>
+        </dependency>
+        <dependency>
+          <groupId>org.apache.hadoop</groupId>
           <artifactId>hadoop-mapreduce-client-jobclient</artifactId>
           <version>${hadoop-23.version}</version>
           <classifier>tests</classifier>
           <scope>test</scope>
         </dependency>
         <dependency>
+          <groupId>org.apache.hadoop</groupId>
+          <artifactId>hadoop-yarn-server-tests</artifactId>
+          <version>${hadoop-23.version}</version>
+          <classifier>tests</classifier>
+          <scope>test</scope>
+        </dependency>
+        <dependency>
           <groupId>org.apache.pig</groupId>
           <artifactId>pig</artifactId>
           <version>${pig.version}</version>
diff --git a/src/hcatalog/storage-handlers/hbase/pom.xml b/src/hcatalog/storage-handlers/hbase/pom.xml
index 8d6311d..27ac445 100644
--- a/src/hcatalog/storage-handlers/hbase/pom.xml
+++ b/src/hcatalog/storage-handlers/hbase/pom.xml
@@ -202,6 +202,19 @@
         <!-- test -->
         <dependency>
           <groupId>org.apache.hadoop</groupId>
+          <artifactId>hadoop-common</artifactId>
+          <version>${hadoop-23.version}</version>
+          <classifier>tests</classifier>
+          <scope>test</scope>
+        </dependency>
+        <dependency>
+          <groupId>org.apache.hadoop</groupId>
+          <artifactId>hadoop-mapreduce-client-hs</artifactId>
+          <version>${hadoop-23.version}</version>
+          <scope>test</scope>
+        </dependency>
+        <dependency>
+          <groupId>org.apache.hadoop</groupId>
           <artifactId>hadoop-mapreduce-client-jobclient</artifactId>
           <version>${hadoop-23.version}</version>
           <classifier>tests</classifier>
@@ -214,6 +227,13 @@
           <classifier>tests</classifier>
           <scope>test</scope>
         </dependency>
+       <dependency>
+         <groupId>org.apache.hadoop</groupId>
+         <artifactId>hadoop-yarn-server-tests</artifactId>
+         <version>${hadoop-23.version}</version>
+         <classifier>tests</classifier>
+         <scope>test</scope>
+       </dependency>
         <dependency>
           <groupId>org.apache.hbase</groupId>
           <artifactId>hbase-common</artifactId>
diff --git a/src/itests/qtest/pom.xml b/src/itests/qtest/pom.xml
index f163820..08d0a23 100644
--- a/src/itests/qtest/pom.xml
+++ b/src/itests/qtest/pom.xml
@@ -312,12 +312,6 @@
           <groupId>org.apache.hbase</groupId>
           <artifactId>hbase-server</artifactId>
           <version>${hbase.hadoop2.version}</version>
-          <scope>test</scope>
-        </dependency>
-        <dependency>
-          <groupId>org.apache.hbase</groupId>
-          <artifactId>hbase-server</artifactId>
-          <version>${hbase.hadoop2.version}</version>
           <classifier>tests</classifier>
           <scope>test</scope>
         </dependency>
-- 
1.7.0.4

